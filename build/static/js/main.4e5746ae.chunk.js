(this["webpackJsonpthe-phonebook"]=this["webpackJsonpthe-phonebook"]||[]).push([[0],{20:function(e,n,t){},41:function(e,n,t){"use strict";t.r(n);var o=t(1),c=t(15),r=t.n(c),i=(t(20),t(3)),a=t(0),u=function(e){return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("form",{onSubmit:e.onSubmit,children:[Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{children:["Name:"," ",Object(a.jsx)("input",{id:"name-input",onChange:e.onChangeName,value:e.name})]}),Object(a.jsxs)("div",{children:["Number:"," ",Object(a.jsx)("input",{id:"num-input",onChange:e.onChangeNumber,value:e.number})]})]}),Object(a.jsx)("div",{children:Object(a.jsx)("button",{type:"submit",children:"Add"})})]})})},s=function(e){var n=e.type,t=e.onChange;return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("label",{children:["Search",Object(a.jsx)("input",{id:"search-input",type:n,onChange:t})]})})},l=function(e){return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("li",{style:{listStyleType:"none"},children:[e.name," - ",e.number,Object(a.jsx)("button",{onClick:e.onClick,children:"delete"})]})})},d=function(e){var n=e.toShow,t=e.onClick;return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("ul",{children:n.map((function(e){return Object(a.jsx)(l,{name:e.name,number:e.number,onClick:function(){return t(e.id)}},e.id)}))})})},b=t(4),j=t.n(b),m="/api/persons",f={getAll:function(){return j.a.get(m).then((function(e){return e.data}))},create:function(e){return j.a.post(m,e).then((function(e){return e.data}))},update:function(e,n){return j.a.put("".concat(m,"/").concat(e),n).then((function(e){return e.data}))},deletePerson:function(e){return j.a.delete("".concat(m,"/").concat(e)).then((function(e){return e.data}))}},h=function(e){var n=e.message,t=e.errorStyle;return null===n?null:Object(a.jsx)("div",{style:t,children:n})},g={color:"green",background:"lightgrey",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginBottom:10},O={color:"red",background:"lightgrey",fontSize:20,borderStyle:"solid",borderRadius:5,padding:10,marginBottom:10},p=function(){var e=Object(o.useState)([]),n=Object(i.a)(e,2),t=n[0],c=n[1],r=Object(o.useState)(""),l=Object(i.a)(r,2),b=l[0],j=l[1],m=Object(o.useState)(""),p=Object(i.a)(m,2),x=p[0],v=p[1],w=Object(o.useState)(null),C=Object(i.a)(w,2),S=C[0],y=C[1],k=Object(o.useState)(t),N=Object(i.a)(k,2),L=N[0],T=N[1],I=Object(o.useState)(null),A=Object(i.a)(I,2),B=A[0],F=A[1],P=Object(o.useState)(null),E=Object(i.a)(P,2),z=E[0],D=E[1],J=document.getElementById("name-input");Object(o.useEffect)((function(){f.getAll().then((function(e){c(e),T(e),console.log(e)}))}),[]);return Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{children:"Phonebook"}),Object(a.jsx)(h,{message:B,errorStyle:z}),Object(a.jsx)(s,{type:"text",onChange:function(e){var n=e.target.value;if(""===n)T(t);else{var o=t.filter((function(e){return e.name.toLowerCase().includes(n.toLowerCase())}));T(o)}}}),Object(a.jsx)("h2",{children:"Add To Phonebook"}),Object(a.jsx)(u,{onSubmit:function(e){if(e.preventDefault(),!0===S){if(window.confirm("".concat(b," is already added to phonebook, replace the old number with a new one?"))){var n=t.filter((function(e){return e.name.toLowerCase()===b.toLowerCase()})),o=n.map((function(e){return e.id})),r={name:b,number:x};console.log("existing person",n),console.log("existing id",o),f.update(o,r).then((function(e){var o=t.findIndex((function(e){return e.name===n[0].name})),r=t.slice();r.splice(o,1,e),c(r),T(r),j(""),v(""),console.log("updated person",e),console.log("index of existing person",o),console.log("new array",r),F("".concat(b,"'s record is updated.")),D(g),setTimeout((function(){F(null)}),2e3)})).catch((function(){D(O),F("Information of ".concat(b," has already been removed from server")),setTimeout((function(){F(null),window.location.reload()}),2e3),j(""),v("")}))}J.focus()}else{var i={name:b,number:x};f.create(i).then((function(e){var n=t.slice();n.push(e),c(n),T(n),j(""),v(""),J.focus(),console.log(n),D(g),F("".concat(b," is added to phonebook.")),setTimeout((function(){F(null)}),2e3)}))}},onChangeName:function(e){var n=e.target.value,o=t.some((function(e){return e.name.toLowerCase()===n.toLowerCase()}));y(!!o),j(n),console.log(n),console.log("Name is existing?",o)},onChangeNumber:function(e){v(e.target.value)},name:b,number:x}),Object(a.jsx)("h2",{children:"Numbers"}),Object(a.jsx)(d,{toShow:L,onClick:function(e){var n=t.find((function(n){return n.id===e})),o=t.findIndex((function(e){return e.name===n.name}));console.log("selected:",n,"with index of",o),window.confirm("Delete ".concat(n.name,"?"))&&f.deletePerson(e).then((function(){t.splice(o,1);var e=t.slice();console.log(e),c(e),T(e)})),D(g),F("".concat(n.name," has been deleted.")),setTimeout((function(){F(null)}),2e3)}})]})};r.a.render(Object(a.jsx)(p,{}),document.getElementById("root"))}},[[41,1,2]]]);
//# sourceMappingURL=main.4e5746ae.chunk.js.map